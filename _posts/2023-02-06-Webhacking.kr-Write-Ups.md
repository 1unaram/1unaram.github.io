---
title: Webhacking.kr Write-Ups
date: 2023-02-06 00:00:00
categories: [Write-Up]
tags: [webhacking, webhacking.kr]   
published: true 
---



## ğŸš© old-01

![image](https://user-images.githubusercontent.com/37824335/227117786-19627989-fd23-4052-bfee-f9f956ccdb3e.png)

ë¬¸ì œ í˜ì´ì§€ë¡œ ì´ë™í•˜ë©´ ìœ„ì™€ ê°™ì€ í™”ë©´ì„ ë³¼ ìˆ˜ ìˆë‹¤. view-sourceë¥¼ ëˆŒëŸ¬ ì½”ë“œë¥¼ í™•ì¸í•´ë³´ì.

<br>

```php
<?php
  include "../../config.php";
  if($_GET['view-source'] == 1){ view_source(); }
  if(!$_COOKIE['user_lv']){
    SetCookie("user_lv","1",time()+86400*30,"/challenge/web-01/");
    echo("<meta http-equiv=refresh content=0>");
  }
?>
```

ìƒë‹¨ ì½”ë“œì—ì„œ ì¤‘ìš”í•œ ë¶€ë¶„ì€ `user_lv` ì´ë¦„ì˜ ì¿ í‚¤ ê°’ì„ ì„¤ì •í•˜ëŠ” ë¶€ë¶„ì¸ ê²ƒ ê°™ë‹¤.

<br>

```php
<?php
  if(!is_numeric($_COOKIE['user_lv'])) $_COOKIE['user_lv']=1;
  if($_COOKIE['user_lv']>=4) $_COOKIE['user_lv']=1;
  if($_COOKIE['user_lv']>3) solve(1);
  echo "<br>level : {$_COOKIE['user_lv']}";
?>
```

í•˜ë‹¨ ì½”ë“œì—ì„œ ë¬¸ì œë¥¼ í’€ ìˆ˜ ìˆëŠ” íŒíŠ¸ë¥¼ ì–»ì—ˆë‹¤. `user_lv` ëª…ì˜ ì¿ í‚¤ ê°’ì´ 3 ì´ˆê³¼ 4 ë¯¸ë§Œì´ì–´ì•¼ ë¬¸ì œë¥¼ í’€ ìˆ˜ ìˆìŒì„ í™•ì¸í•˜ì˜€ë‹¤. 

<br>

![image](https://user-images.githubusercontent.com/37824335/227118033-515bd877-0e13-47de-9607-97e977549fe9.png){: w="300"}


ë©”ì¸ í˜ì´ì§€ë¡œ ì´ë™í•˜ì—¬ ì¿ í‚¤ ê°’ì„ í•´ë‹¹ ë²”ìœ„ì˜ ìˆ˜ì— ì†í•˜ëŠ” 3.5ë¡œ ìˆ˜ì •í•˜ë©´

<br>

![image](https://user-images.githubusercontent.com/37824335/227118145-300cef3b-a8e6-4e1a-8ee8-966fe320e737.png)

í’€ë¦°ë‹¤!

<br>

---

## ğŸš© old-06

![image](https://user-images.githubusercontent.com/37824335/227118210-dbd8c09c-39ab-450d-b61c-235cf38681e5.png)

ë¬¸ì œ í˜ì´ì§€ì— ë“¤ì–´ê°€ë©´ ìœ„ì™€ ê°™ì€ í˜ì´ì§€ê°€ ë³´ì¸ë‹¤. view-sourceë¥¼ í´ë¦­í•´ë³´ë‹ˆ phpì½”ë“œë¥¼ ë³¼ ìˆ˜ ìˆì—ˆë‹¤. í•µì‹¬ ì½”ë“œë§Œì„ ë³´ì.

<br>

![image](https://user-images.githubusercontent.com/37824335/227118267-e76ed68f-3b11-4959-9a6d-2a4478488b1e.png){: w="600"}

`user`ëª…ì˜ ì¿ í‚¤ ê°’ì´ ì¡´ì¬í•˜ëŠ” ê²½ìš°ì— ìœ„ì˜ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ëŠ” ê²ƒìœ¼ë¡œ ë³´ì¸ë‹¤. `guest`ì™€ `123qwe` ë¬¸ìì—´ì„ ê°ê° idì™€ pwê°’ìœ¼ë¡œ ì„¤ì •í•œ í›„ í•´ë‹¹ ë¬¸ìì—´ì„ 20ë²ˆ ë°˜ë³µí•˜ì—¬ **base64** ì¸ì½”ë”©í•œ ë‹¤ìŒì— ì¸ì½”ë”©í•œ ê° ë¬¸ìì—´ì—ì„œ 1, 2, 3, 4, 5, 6, 7, 8 ë¬¸ìë¥¼ ê°ê°ì˜ ë¬¸ìë¡œ ì¹˜í™˜í•œë‹¤. ê·¸ë ‡ê²Œ ë‚˜ì˜¨ ê²°ê³¼ id, pw ë¬¸ìì—´ì„ ì¿ í‚¤ë¡œ ì„¤ì •í•˜ëŠ” ë™ì‘ì´ë‹¤.

<br>

![image](https://user-images.githubusercontent.com/37824335/227118340-fe19aba8-7e24-46c0-9c86-387d26435186.png){: w="500"}

í•´ë‹¹ ì›¹í˜ì´ì§€ì˜ ì¿ í‚¤ë¥¼ ì‚´í´ë³´ë‹ˆ base64ë¡œ ì¸ì½”ë”© ëœ ê²ƒìœ¼ë¡œ ë³´ì´ëŠ” ë¬¸ìì—´ì´ value ê°’ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆì—ˆë‹¤. HTML ì½”ë“œ í•˜ë‹¨ì˜ php ì½”ë“œë¥¼ ì‚´í´ë³´ì.

<br>

![image](https://user-images.githubusercontent.com/37824335/227118428-b3e2381b-c5dd-45bf-b9ce-84f79918a880.png){: w="600"}

ì½”ë“œì—ì„œ í•„ìš”ì—†ëŠ” ë¶€ë¶„ì€ ì§€ì› ë‹¤. í•´ë‹¹ ì½”ë“œëŠ” `user`, `password` nameì˜ ì¿ í‚¤ ê°’ì„ ê°€ì ¸ì™€ ìœ„ì—ì„œ ì§„í–‰í•œ ë¬¸ìì—´ ì¹˜í™˜ì˜ ì—­ì„ ìˆ˜í–‰í•˜ê³ , base64 ë¬¸ìì—´ì„ 20ë²ˆ ë°˜ë³µ decodeí•˜ì—¬ ê²°ê³¼ ë¬¸ìì—´ì´ idì™€ passwwordê°€ ê°ê° `admin`ê³¼ `nimda`ë¼ëŠ” ë¬¸ìì—´ê³¼ ì¼ì¹˜í•˜ë©´ ë¬¸ì œê°€ í’€ë¦¬ëŠ” ë“¯í•˜ë‹¤. ê·¸ëŸ¼ ìš°ë¦¬ëŠ” `admin`ê³¼ `nimda`ë¥¼ ì—­ìœ¼ë¡œ ì¹˜í™˜í•˜ê³ , base64 decodeë¥¼ 20ë²ˆ ìˆ˜í–‰í•˜ì—¬ ë‚˜ì˜¨ ë¬¸ìì—´ì„ ì¿ í‚¤ë¡œ ê°ê° ì„¤ì •í•˜ë©´ ë¬¸ì œê°€ í’€ë¦¬ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. ë‹¨ìˆœ ë°˜ë³µ ê³¼ì •ì´ë‹ˆ Pythonìœ¼ë¡œ ì½”ë“œë¥¼ ì§œë³´ì. 

<br />

```python
import base64
```
base64 ì¸ì½”ë”©ê³¼ ë””ì½”ë”© ê³¼ì •ì´ í•„ìš”í•˜ë¯€ë¡œ python ë‚´ì¥ ëª¨ë“ˆ **base64**ë¥¼ ì‚¬ìš©í•˜ì.

<br>

![image](https://user-images.githubusercontent.com/37824335/227119124-a3a9a5de-c9e1-4372-bb8b-2bf09d5e73fe.png)

ì—­ìœ¼ë¡œ ì¹˜í™˜í•˜ëŠ” ê³¼ì •ì€ í•¨ìˆ˜ë¡œ êµ¬í˜„í•˜ì—¬ ë¬¸ìì—´ idì™€ pwë¥¼ ì—­ìœ¼ë¡œ ì¹˜í™˜í•œ ë¬¸ìì—´ì„ ì‰½ê²Œ êµ¬í•´ë‚¼ ìˆ˜ ìˆì—ˆë‹¤.

<br>

![image](https://user-images.githubusercontent.com/37824335/227119141-00fc28ca-1ed1-4237-a9cf-7e9baaf7030f.png)

ê·¸ë¦¬ê³  ê°ê° ìœ„ì—ì„œ ì„¤ëª…í•˜ì˜€ë˜ ê³¼ì •ëŒ€ë¡œ ì½”ë“œë¥¼ ì§„í–‰í•˜ê³  ì¶œë ¥í•œ ê°’ì„ ì¿ í‚¤ë¡œ ì„¤ì •í•˜ë‹ˆ

<br>

![image](https://user-images.githubusercontent.com/37824335/227119180-0b80c45b-ce97-4437-b94a-e75939cecf34.png)

í’€ë ¸ë‹¤!

<br>

---

## ğŸš© old-10

![image](https://user-images.githubusercontent.com/37824335/227119274-751be999-20f4-4cf3-9b97-20f837490425.png)

ë¬¸ì œ í˜ì´ì§€ì— ë“¤ì–´ê°€ë‹ˆ íŠ¸ë™ì„ ì—°ìƒí•˜ê²Œ í•˜ëŠ” ê·¸ë¦¼ì´ ìˆì—ˆë‹¤. ì†ŒìŠ¤ì½”ë“œë¥¼ ë¨¼ì € ì‚´í´ë³´ì•˜ë‹¤.

<br>

![image](https://user-images.githubusercontent.com/37824335/227119312-fb3603a0-28bf-45b6-bc13-303ff1436ce5.png)

ë‹¤ë¥¸ ë¶€ë¶„ì€ í™”ë©´ì„ ê·¸ë¦¬ëŠ” íƒœê·¸ë“¤ì´ ì¡´ì¬í•˜ì˜€ê³ , íŠ¸ë™ ìœ„ì˜ **O**ë¥¼ ê·¸ë¦¬ëŠ” íƒœê·¸ëŠ” `onclick`, `onmouseover`, `onmouseout` ì†ì„±ì„ ê°€ì§€ê³  ìˆì—ˆë‹¤.
`onmouseover`ê³¼ `onmouseout` ì†ì„±ì€ **O** ê¸€ìì™€ **yOu** ê¸€ìë¥¼ ë³€ê²½í•˜ëŠ” ì—­í• ì„ í•˜ì˜€ê³ , `onclick` ì†ì„±ì€ í´ë¦­ ì‹œì— 1pxì”© ê¸€ìë¥¼ ì˜¤ë¥¸ìª½ìœ¼ë¡œ ì˜®ê¸°ëŠ” ì—­í• ì„ í•˜ê³  ìˆì—ˆë‹¤. í´ë¦­í•´ë³´ë©´ 

<br>

![image](https://user-images.githubusercontent.com/37824335/227119343-5bb739ee-6ac7-4bf9-b39b-71b601b5cbdd.png)

ì¡°ê¸ˆì”© ì´ë™í•¨ì„ ì•Œ ìˆ˜ ìˆì—ˆëŠ”ë°, `onclick` ì†ì„±ì—ì„œ í•´ë‹¹ ê¸€ì ìŠ¤íƒ€ì¼ ì†ì„±ì˜ left ê°’ì´ 1600pxì´ ë˜ë©´ íŠ¹ì • í˜ì´ì§€ë¡œ ì´ë™í•¨ì„ ì•Œ ìˆ˜ ìˆì—ˆë‹¤.

<br>

![image](https://user-images.githubusercontent.com/37824335/227119651-3d667c9f-8cdc-4f1e-8606-6d0bb03605de.png)

ê·¸ë˜ì„œ í•´ë‹¹ íƒœê·¸ì˜ left ê°’ì„ 1599pxë¡œ ì„¤ì •í•˜ê³  ê¸€ìë¥¼ í•œ ë²ˆ í´ë¦­í•˜ë‹ˆ 1600pxì´ ë˜ë©´ì„œ

<br>

![image](https://user-images.githubusercontent.com/37824335/227119697-86c54244-dbdd-4ead-8301-4df11ef7c609.png)

ë¬¸ì œê°€ í’€ë ¸ë‹¤!

<br>

---

## ğŸš© old-11

![image](https://user-images.githubusercontent.com/37824335/227119817-0b60a882-dae4-4c70-8375-77e7cb5b43b1.png)

ë¬¸ì œ í˜ì´ì§€ì— ë“¤ì–´ê°€ë©´ ìœ„ì™€ ê°™ì€ í™”ë©´ì„ ë³¼ ìˆ˜ ìˆë‹¤. view-sourceë¥¼ ëˆŒëŸ¬ ì½”ë“œë¥¼ í™•ì¸í•´ë³´ì.

<br>

```php
<?php
  $pat="/[1-3][a-f]{5}_.*$_SERVER[REMOTE_ADDR].*\tp\ta\ts\ts/";
  if(preg_match($pat,$_GET['val'])){
    solve(11);
  }
  else echo("<h2>Wrong</h2>");
  echo("<br><br>");
?>
```

í•´ë‹¹ ë¶€ë¶„ì´ ì¤‘ìš”í•œ ë¡œì§ì¸ë°, `$pat` ë³€ìˆ˜ì— ì •ê·œì‹ ë¬¸ìì—´ì„ í• ë‹¹í•˜ê³  í•´ë‹¹ ì •ê·œì‹ê³¼ `val` ëª…ì˜ ì¸ì ê°’ì„ ë¹„êµí•˜ì—¬ ì •ê·œì‹ê³¼ ë§¤ì¹­í•˜ëŠ”ì§€ ê²€ì‚¬í•œë‹¤. ì •ê·œì‹ì„ ë¶„ì„í•´ë³´ë©´

- **[1-3]** : 1-3 ë²”ìœ„ì˜ ìˆ«ì
- **[a-f]{5}** : a-f ë²”ìœ„ì˜ ë¬¸ì - ìµœì†Œ 5ê°œ
- **_** : _ ë¬¸ì í•˜ë‚˜
- **.*** : ì–´ë–¤ ë¬¸ìì—´ì´ë“  zero or more
- **$_SERVER[REMOTE_ADDR]** : ì ‘ì†í•œ í´ë¼ì´ì–¸íŠ¸ì˜ IP ì£¼ì†Œë¥¼ ë‚˜íƒ€ë‚´ëŠ” PHP í™˜ê²½ë³€ìˆ˜
- **\t** : tab ë¬¸ì
- **p** : p ë¬¸ì
- **a** : a ë¬¸ì
- **s** : s ë¬¸ì

ì´ë¥¼ ë§Œì¡±ì‹œí‚¤ëŠ” ë¬¸ìì—´ì„ `val` ì¸ìë¡œ ì „ë‹¬í•´ì•¼ í•œë‹¤. ì •ê·œì‹ì„ ì¶©ì¡±ì‹œí‚¤ëŠ” ë¬¸ìì—´ì„ ì‘ì„±í•´ë³´ë©´,
`1aaaaa_[ipì£¼ì†Œ]%09p%09a%09s%09s`
ê°€ ë  ìˆ˜ ìˆë‹¤. ì—¬ê¸°ì„œ %09ëŠ” tab ë¬¸ìë¥¼ url encode ë°©ì‹ìœ¼ë¡œ ë‚˜íƒ€ë‚¸  ê²ƒì´ë‹¤. 

`https://webhacking.kr/challenge/code-2/?val=1aaaaa_[ipì£¼ì†Œ]%09p%09a%09s%09s`
ì´ë¥¼ ì£¼ì†Œì°½ì— ì¸ìë¡œ ì…ë ¥í•˜ì—¬ GET ë°©ì‹ìœ¼ë¡œ ë„˜ê²¨ì£¼ë©´,

<br>

![image](https://user-images.githubusercontent.com/37824335/227119895-001bc291-9682-4cb0-9693-d62ffaaa2f17.png)

í’€ë¦°ë‹¤!

<br>

---

## ğŸš© old-14

![image](https://user-images.githubusercontent.com/37824335/227119952-af1e09d2-1cee-44da-9b4c-5c71a3d5164f.png)

ë¬¸ì œ í˜ì´ì§€ì— ë“¤ì–´ê°€ë³´ë‹ˆ input ì°½ê³¼ check ë²„íŠ¼ë§Œì´ ë†“ì—¬ìˆì—ˆë‹¤. ì†ŒìŠ¤ì½”ë“œ ë¨¼ì € í™•ì¸í•´ë³´ì•˜ë‹¤.

<br>

![image](https://user-images.githubusercontent.com/37824335/227119993-0945b50e-4099-4e80-9a63-eefbeb77d766.png)

form íƒœê·¸ ë‚´ì— input íƒœê·¸ ë‘ ê°œê°€ ìˆì—ˆê³  ê·¸ ì¤‘ ë²„íŠ¼ì— `ck()` í•¨ìˆ˜ê°€ onClilck ì†ì„±ìœ¼ë¡œ ì§€ì •ë˜ì–´ ìˆì—ˆë‹¤. ìŠ¤í¬ë¦½íŠ¸ êµ¬ë¬¸ì— `ck()` í•¨ìˆ˜ì˜ ë‚´ìš©ì´ ìˆì—ˆê³ , ì…‹ ì§¸ì¤„ê¹Œì§€ëŠ” ëŒ€ëµ ë¸Œë¼ìš°ì €ì˜ URLì˜ ".kr" ë¬¸ìì—´ì˜ ì¸ë±ìŠ¤ ê°’ì— 30ì„ ê³±í•œ ê°’ì„ `ul` ë³€ìˆ˜ì— ì €ì¥í•˜ê³  ìˆì—ˆë‹¤. ì´ë¥¼ ì…ë ¥í•´ì•¼ í•˜ëŠ” ê²ƒìœ¼ë¡œ ë³´ì˜€ë‹¤. 

<br>

![image](https://user-images.githubusercontent.com/37824335/227120026-5002bcf2-2525-4cfd-bc0c-9666510c45b5.png){: w="300"}

`ul` ê°’ì„ ì•Œì•„ë‚´ê¸° ìœ„í•´ ì½˜ì†” ì°½ì—ì„œ êµ¬ë¬¸ì„ ì‹¤í–‰í•˜ì—¬ ë‚˜ì˜¨ ìˆ«ì ê°’ì„ ì…ë ¥í•˜ë‹ˆ

![](https://velog.velcdn.com/images/1unaram/post/f9161049-bf77-4bb0-86f8-61ba08cfad33/image.png)

í’€ë ¸ë‹¤!

<br>

---

## ğŸš© old-16

![image](https://user-images.githubusercontent.com/37824335/227120196-634574ca-75bb-46ef-8dc6-19c08a75130e.png)

ë¬¸ì œ í˜ì´ì§€ì— ë“¤ì–´ê°€ë‹ˆ ìƒ‰ì„ ê°€ì§„ ì•„ìŠ¤íƒ€ë¦¬ìŠ¤í¬(*)ê°€ ë³´ì˜€ë‹¤. ì†ŒìŠ¤ì½”ë“œë¶€í„° ë³´ì•˜ë‹¤.

<br>

![image](https://user-images.githubusercontent.com/37824335/227120237-91609ee6-8280-4d19-a255-0d383f3212d0.png)

body íƒœê·¸ì—ëŠ” font íƒœê·¸ 4ê°œ ì‚¬ì´ì— scriptë¬¸ì´ ë“¤ì–´ìˆì—ˆë‹¤. body íƒœê·¸ì—ëŠ” í‚¤ë³´ë“œ ì´ë²¤íŠ¸ ë°œìƒ ì‹œì— keyCode ê°’ì„ `mv()` í•¨ìˆ˜ì˜ ì¸ìë¡œ ì „ë‹¬í•˜ê³  ìˆë‹¤. `mv()` í•¨ìˆ˜ ë‚´ì—ì„œëŠ” `kk()` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ê³  ìˆëŠ”ë° ì´ í•¨ìˆ˜ëŠ” ìƒì„±ëœ ë‚œìˆ˜ë¡œ 6ìë¦¬ ìì—°ìˆ˜ë¥¼ ë§Œë“¤ì–´ í•´ë‹¹ ìˆ«ìì— í•´ë‹¹í•˜ëŠ” ìƒ‰ìƒ ì½”ë“œì˜ ìƒ‰ì„ ê°€ì§„ *ë¥¼ ìƒì„±í•˜ê³  ìˆë‹¤.

<br>

![image](https://user-images.githubusercontent.com/37824335/227120279-2bfa72df-2102-44e4-80e5-603f26650680.png)

í‚¤ë³´ë“œë¥¼ ë§‰ ëˆ„ë¥´ë©´ ì´ëŸ° í™”ë©´ì„ ë³¼ ìˆ˜ ìˆë‹¤. ì´ ë™ì‘ì€ ì¤‘ìš”í•˜ì§€ ì•Šê³ , `mv()` í•¨ìˆ˜ ë‚´ì˜ ë§ˆì§€ë§‰ `if`ë¬¸ì€ keyCode ê°’ì´ 124ì™€ ê°™ìœ¼ë©´ php ë™ì‘ì„ í•˜ëŠ” ë°©ì‹ì´ë‹¤. ASCII code 124ë²ˆì€ `|` ë¬¸ìë¥¼ ì˜ë¯¸í•˜ê¸°ì— í‚¤ë³´ë“œë¡œ ì…ë ¥í•˜ë©´

<br>

![image](https://user-images.githubusercontent.com/37824335/227120330-510ef5ff-d517-4429-b78a-d3c258fd75aa.png)

í’€ë ¸ë‹¤ !

<br>

---

## ğŸš© old-17

![image](https://user-images.githubusercontent.com/37824335/227120443-578ea08a-9a20-4303-810c-783d0fb6d0c7.png)

ë¬¸ì œ í˜ì´ì§€ì— ë“¤ì–´ê°€ë‹ˆ 14ë²ˆê³¼ ë§ˆì°¬ê°€ì§€ë¡œ ì…ë ¥ ì°½ê³¼ check ë²„íŠ¼ì´ ìˆì—ˆë‹¤. ì†ŒìŠ¤ì½”ë“œë¥¼ ë¨¼ì € ë³´ì•˜ë‹¤.

<br>

![image](https://user-images.githubusercontent.com/37824335/227120473-1b92567a-8a8b-43cc-acf2-02b6546615cd.png)

14ë²ˆê³¼ ìœ ì‚¬í•œ ë¬¸ì œì„ì„ ì•Œ ìˆ˜ ìˆì—ˆê³  ë§ˆì°¬ê°€ì§€ë¡œ ì½˜ì†” ì°½ì—ì„œ `unlock` ë³€ìˆ˜ë¥¼ ê³„ì‚° í•´ë³´ì•˜ë‹¤.

<br>

![image](https://user-images.githubusercontent.com/37824335/227120500-bb21092f-c5ba-451a-8146-b66a6aa093fb.png)

ì—°ì‚°í•˜ì—¬ ë‚˜ì˜¨ ê²°ê³¼ë¥¼ inputì— ì…ë ¥í•˜ê³  ë²„íŠ¼ì„ í´ë¦­í•˜ë©´

<br>

![image](https://user-images.githubusercontent.com/37824335/227120520-cc52d694-79d5-4b9c-8e22-3d81e9617bf7.png)

í’€ë ¸ë‹¤!

<br>

---


## ğŸš© old-18

![image](https://user-images.githubusercontent.com/37824335/227120579-af1ad117-8511-49d7-b205-62b32059722b.png)

ë¬¸ì œ í˜ì´ì§€ì— ë“¤ì–´ê°€ë©´ ìœ„ì™€ ê°™ì€ í™”ë©´ì´ ë‚˜ì˜¨ë‹¤. ì œëª©ì— í¬ê²Œ ì“°ì—¬ìˆë“¯ì´ SQL Injectionì„ ì‚¬ìš©í•˜ëŠ” ë¬¸ì œì¸ ê²ƒ ê°™ë‹¤. view-sourceë¥¼ ëˆŒëŸ¬ë³´ì.

<br>

![image](https://user-images.githubusercontent.com/37824335/227120688-d99f3c09-9319-4e94-a175-9db87216d1fd.png)

í™ˆí˜ì´ì§€ë¥¼ êµ¬ì„±í•˜ëŠ” PHP íŒŒì¼ì´ ìˆë‹¤. ê·¸ ì¤‘ ì¤‘ìš”í•œ php ì½”ë“œë§Œì„ ë³´ì. 
GET ë°©ì‹ìœ¼ë¡œ `no` íŒŒë¼ë¯¸í„°ë¥¼ ë°›ì•„ì˜¨ë‹¤. ê·¸ ë‹¤ìŒ `preg_match()` í•¨ìˆ˜ë¥¼ í†µí•´ ë°›ì•„ì˜¨ íŒŒë¼ë¯¸í„° ê°’ì—ì„œ ì •ê·œí‘œí˜„ì‹ìœ¼ë¡œ ë§¤ì¹­ë˜ëŠ” ë¬¸ìì—´ì´ ìˆëŠ”ì§€ ê²€ì‚¬í•˜ì—¬ ìˆë‹¤ë©´, ì¢…ë£Œí•˜ëŠ” í˜•ì‹ì´ë‹¤. ì´ë¥¼ ìš°íšŒí•˜ì—¬ **SQL Injection** ê³µê²© ê¸°ë²•ìœ¼ë¡œ ë°ì´í„°ë² ì´ìŠ¤ì„œ ê°’ì„ êº¼ë‚´ì–´ `result` ë³€ìˆ˜ì— "admin" ë¬¸ìì—´ì„ ì§‘ì–´ ë„£ìœ¼ë©´ í’€ë¦¬ëŠ” ë¬¸ì œì´ë‹¤. ë¬¸ìì—´ ìš°íšŒë¥¼ ìœ„í•´ ì •ê·œí‘œí˜„ì‹ì„ ë¶„ì„í•´ë³´ì.

<br>

> ì •ê·œí‘œí˜„ì‹ : `/ |\/|\(|\)|\||&|select|from|0x/i`

- **/ /i** : case insensitive ë°©ì‹ì˜ ì •ê·œí‘œí˜„ì‹ì´ë‹¤. selectì™€ fromì€ ì‚¬ìš©í•˜ì§€ ëª»í•  ê²ƒ ê°™ë‹¤.
- **\|** : orì„ ê¸°ì¤€ìœ¼ë¡œ ë¬¸ìë¥¼ ëŠì„ ìˆ˜ ìˆë‹¤. í•˜ë‚˜ì”© ëŠì–´ì„œ ë³´ì.
- **ê³µë°±** : `ê³µë°±` ë¶ˆê°€
- **/** : `/` ë¶ˆê°€
- **\(** : `(` ë¶ˆê°€
- **\)** : `)` ë¶ˆê°€
- **\|** : `|` ë¶ˆê°€
- **&** : `&` ë¶ˆê°€
- **select** : `select` ë¬¸ìì—´ ë¶ˆê°€(ëŒ€ë¬¸ìë„ ë¶ˆê°€)
- **from** : `from` ë¬¸ìì—´ ë¶ˆê°€(ëŒ€ë¬¸ìë„ ë¶ˆê°€)
- **0x** : `0x` ë¬¸ìì—´ ë¶ˆê°€

<br />

ì´ë“¤ì„ ì‚¬ìš©í•˜ì§€ ì•Šê³  ì•„ë˜ì™€ ê°™ì´ ì‚½ì…ë¬¸ì„ ì‘ì„±í•  ìˆ˜ ìˆë‹¤.
`0%09or%09id='admin'%09and%09no=2`

- **%09** : `Tab` ë¬¸ìì´ë‹¤. ê³µë°± ëŒ€ì‹  ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
- **or** : or ë¬¸ìœ¼ë¡œ id ê°’ì€ `admin`, no ê°’ì€ `2`ì¸ ë°ì´í„°ë¥¼ ë¶„ë³„í•  ìˆ˜ ìˆë‹¤.

<br>

ğŸ”½ ì‚½ì…ëœ SQLë¬¸
```sql
 select id from chall18 where id='guest' and no=0 or id='admin' and no=2
```

ì‚½ì…ë¬¸ì„ URLì„ í†µí•´ ìš”ì²­í•˜ë©´,

<br>

![image](https://user-images.githubusercontent.com/37824335/227121058-235c44f3-282b-406b-81f3-49bab7f4fa73.png){: w="500"}

í’€ë ¸ë‹¤!

<br>

---

## ğŸš© old-20

![image](https://user-images.githubusercontent.com/37824335/227121197-944b0f99-3dbd-4e44-95ee-18f904641bc0.png)

ë¬¸ì œ í˜ì´ì§€ì—ì„œëŠ” ìœ„ì™€ ê°™ì€ êµ¬ì„±ì´ì—ˆê³  ìš°ì„  ì†ŒìŠ¤ì½”ë“œë¥¼ ë³´ì•˜ë‹¤.

<br>

![image](https://user-images.githubusercontent.com/37824335/227121255-bf2f7a4d-4f1c-453d-90eb-5d1118bd6130.png)

input ì°½ë“¤ì€ form íƒœê·¸ ë‚´ì— ìœ„ì¹˜í–ˆê³  submit ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ `ck()`í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ëŠ” í˜•íƒœì˜€ë‹¤. í•¨ìˆ˜ì˜ ë‚´ìš©ì„ ë³´ì•„ nickname, comment, captchaì— ê°’ì„ ì…ë ¥í•´ì•¼ í•˜ë©° ëœë¤ìœ¼ë¡œ ìƒì„±ë˜ëŠ” captcha ë¬¸ìë¥¼ ì•Œë§ê²Œ ì…ë ¥í•´ì•¼ formì˜ submitì´ ì‘ë™í•˜ëŠ”ë“¯ í–ˆë‹¤. 2ì´ˆ ë‚´ì— ì œì¶œí•˜ê¸° ìœ„í•´ì„œëŠ”  pythonì˜ **selenium** ëª¨ë“ˆì„ ì´ìš©í•˜ì˜€ë‹¤.

<br>

ğŸ”½ **import**
```python
from selenium import webdriver
from selenium.webdriver.common.by import By
from webdriver_manager.chrome import ChromeDriverManager
from time import sleep
```

![image](https://user-images.githubusercontent.com/37824335/227121319-c8cc4031-e19a-4b1d-ac00-1fff121909fc.png)

`driver.Chrome()` í•¨ìˆ˜ëŠ” ë¬´ìŠ¨ ì´ìœ ì¸ì§€ ìê¾¸ ì˜¤ë¥˜ê°€ ë‚˜ì„œ ChromeDriverManagerë¥¼ ì´ìš©í•˜ì—¬ í¬ë¡¬ ë“œë¼ì´ë²„ë¥¼ ì…€ë ˆë‹ˆì›€ ë“œë¼ì´ë²„ë¡œ ì„¤ì •í•˜ì˜€ë‹¤.

<br>

![image](https://user-images.githubusercontent.com/37824335/227121347-67d6349d-242c-4590-9f47-b0d8f26420c7.png)

webhacking.kr ì‚¬ì´íŠ¸ëŠ” ë¡œê·¸ì¸ ìƒíƒœì—ì„œ ë¬¸ì œ ì‚¬ì´íŠ¸ì— ì ‘ê·¼í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ì‚¬ìš©ìì—ê²Œ id, passwordë¥¼ ì…ë ¥ ë°›ê³  

<br>

![image](https://user-images.githubusercontent.com/37824335/227121379-9899ebb0-88c4-4f44-9ea5-02cf20e17385.png)

ë¡œê·¸ì¸ ì°½ì˜ ê° íƒœê·¸ì˜ XPATHë¥¼ ë³µì‚¬í•˜ì—¬ id, passwordë¥¼ ì…ë ¥í•˜ê³  ë¡œê·¸ì¸ì„ í•˜ë„ë¡ í•˜ì˜€ë‹¤. ì²˜ìŒì—ëŠ” `find_element_by_xpath()` í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì˜€ìœ¼ë‚˜ DeprecationWarning ë¬¸êµ¬ê°€ ì¶œë ¥ë˜ì–´ `find_element()` í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì˜€ë‹¤.

<br>

![image](https://user-images.githubusercontent.com/37824335/227121673-73765c79-4fac-4b8a-845a-a8f97bdc694d.png)

ë¡œê·¸ì¸ ì„¸ì…˜ì´ ìœ ì§€ëœ ìƒíƒœì—ì„œ ë¬¸ì œ í˜ì´ì§€ë¡œ ì´ë™

<br>

![image](https://user-images.githubusercontent.com/37824335/227121723-3e4a93ca-9ae4-4275-827d-cb4c256e2999.png)

ë¬¸ì œ í˜ì´ì§€ë¡œ ì´ë™ í›„ nicknameê³¼ commentì—ëŠ” ì•„ë¬´ ë¬¸ìë¥¼ ì±„ì›Œë„£ê³ , captchaì˜ value ì†ì„± ê°’ì„ ê°€ì ¸ì™€ captchaë¡œ ì…ë ¥í•˜ê³ , submit ë²„íŠ¼ì„ í´ë¦­í•˜ë„ë¡ í•˜ì˜€ë‹¤.

<br>

![image](https://user-images.githubusercontent.com/37824335/227121802-63f64b35-ed74-4444-bb4b-cd2bc827b524.png){: w="400"}

ì‹¤í–‰ ì‹œí‚¤ë‹ˆ í’€ë ¸ë‹¤ !

<br>

---

## ğŸš© old-27

![image](https://user-images.githubusercontent.com/37824335/227121891-0e54b8b6-b567-4c1c-b69f-e2a950929b72.png)

18ë²ˆ ë¬¸ì œì™€ ê°™ì€ SQL Injection ë¬¸ì œì´ë‹¤. ë§ˆì°¬ê°€ì§€ë¡œ ì†ŒìŠ¤ì½”ë“œ ë‚´ì—ì„œ ì¤‘ìš”í•œ ë¶€ë¶„ë§Œì„ ë³´ì.

<br>

![image](https://user-images.githubusercontent.com/37824335/227121916-6dca857f-541f-468f-b392-5d9fa99d1999.png)

ê°™ì€ ë°©ì‹ìœ¼ë¡œ ì •ê·œí‘œí˜„ì‹ì„ ì´ìš©í•˜ì—¬ ë¬¸ìì—´ì„ ê²€ì‚¬í•˜ê³  dbì˜ ë°ì´í„°ë¥¼ ì ‘ê·¼í•œë‹¤. ì •ê·œí‘œí˜„ì‹ì„ ë¶„ì„í•´ë³´ì.

<br>

> ì •ê·œí‘œí˜„ì‹ : `/#|select|\(| |limit|=|0x/i`

- **/ /i** : case insensitive ë°©ì‹ì˜ ì •ê·œí‘œí˜„ì‹ì´ë‹¤. selectì™€ fromì€ ì‚¬ìš©í•˜ì§€ ëª»í•  ê²ƒ ê°™ë‹¤.
- **\|** : orì„ ê¸°ì¤€ìœ¼ë¡œ ë¬¸ìë¥¼ ëŠì„ ìˆ˜ ìˆë‹¤. í•˜ë‚˜ì”© ëŠì–´ì„œ ë³´ì.
- **#** : `#` ë¶ˆê°€
- **select** : `select` ë¬¸ìì—´ ë¶ˆê°€(ëŒ€ë¬¸ìë„ ë¶ˆê°€)
- **\(** : `(` ë¶ˆê°€
- **ê³µë°±** : `ê³µë°±` ë¶ˆê°€
- **limit** : `limit` ë¬¸ìì—´ ë¶ˆê°€(ëŒ€ë¬¸ìë„ ë¶ˆê°€)
- **=** : `=` ë¶ˆê°€
- **0x** : `0x` ë¬¸ìì—´ ë¶ˆê°€

<br>

18ë²ˆ ë¬¸ì œì™€ëŠ” ë‹¤ë¥´ê²Œ ê´„í˜¸()ê°€ SQLë¬¸ì— ë“¤ì–´ìˆë‹¤. ì´ë¥¼ ìœ ì˜í•˜ì—¬ ì•„ë˜ì™€ ê°™ì´ ì‚½ì…ë¬¸ì„ ì‘ì„±í•  ìˆ˜ ìˆë‹¤.

> `0)%09or%09id%09like%09'admin'%09and%09no>1%09and%09no<3%09;%00`

- **)** : ê´„í˜¸ë¥¼ ë‹«ì•„ì£¼ì–´ êµ¬ë¬¸ì„ ë¶„ë¦¬í•˜ì.
- **%09** : `Tab` ë¬¸ìì´ë‹¤. ê³µë°± ëŒ€ì‹  ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
- **like** : `=` ë¬¸ì ëŒ€ì‹  ë¬¸ìì—´ì„ ë¹„êµí•  ìˆ˜ ìˆëŠ” ì—°ì‚°ìì´ë‹¤. `id='admin'`ê³¼ ê°™ì€ ê¸°ëŠ¥.
- **no>1 and no<3** : `=` ë¬¸ì ëŒ€ì‹  ìˆ«ì ë¹„êµë¥¼ ìœ„í•´ ë¶€ë“±í˜¸ë¡œ ìˆ«ì 2ë¡œ ì œí•œí•˜ì.
- **;%00** : ë’¤ì— ìˆëŠ” `)` ë¬¸ìë¥¼ ìƒì‡„ì‹œí‚¤ê¸° ìœ„í•´ ì£¼ì„ ì—­í• ì„ í•˜ëŠ” ë¬¸ìë¥¼ ë„£ì–´ì£¼ì.

<br>

ğŸ”½ ì‚½ì…ëœ SQLë¬¸
```sql
select id from chall27 where id='guest' and no=(0) or id like 'admin' and no>1 and no<3 ;%00)
```

<br>

URLë¡œ ìš”ì²­í•˜ë©´,

![image](https://user-images.githubusercontent.com/37824335/227122102-795ebd56-7932-4a2f-b420-993a4855eb5a.png)

í’€ë¦°ë‹¤!

<br>

---

## ğŸš© old-32

![image](https://user-images.githubusercontent.com/37824335/227122221-077240f1-6718-41c2-91ed-81a145b0f263.png){: w="400"}


ë¬¸ì œ í˜ì´ì§€ì— ë“¤ì–´ê°€ë‹ˆ 1500ì—¬ê°œì˜ Webhacking.kr ìœ ì €ì˜ ëª©ë¡ì´ ìˆì—ˆê³  ìœ ì €ë³„ë¡œ hit ì ìˆ˜ê°€ ìˆì—ˆë‹¤. ìœ ì € í•œ ëª…ì„ í´ë¦­í•˜ë‹ˆ ê·¸ì˜ hitì´ ëŠ˜ì–´ë‚œ ê²ƒìœ¼ë¡œ ë³´ì•„ 100ë²ˆ í´ë¦­í•´ì•¼ í•˜ëŠ” ë¬¸ì œë¡œ ë³´ì˜€ë‹¤. ê·¸ëŸ¬ë‚˜ í•œ ë²ˆ hití•œ í›„ë¡œëŠ” 

<br>

![image](https://user-images.githubusercontent.com/37824335/227122299-0ae1ba5b-d78e-4cdf-85a9-2cde3f3bfac3.png)

ë‹¤ìŒê³¼ ê°™ì€ ë¬¸êµ¬ì™€ í•¨ê»˜ hitë¥¼ í•  ìˆ˜ ì—†ì—ˆë‹¤.

<br>

![image](https://user-images.githubusercontent.com/37824335/227122345-fde90a16-5ca8-41c2-a26b-3ccc347f7e92.png)

cookieë¥¼ í™•ì¸í•´ë³¸ ê²°ê³¼ vote_checkëª…ì˜ ê°’ìœ¼ë¡œ okê°€ ì„¸íŒ…ëœ ê²ƒì„ ë³¼ ìˆ˜ ìˆì—ˆê³  ì´ë¥¼ ì‚­ì œí•˜ë‹ˆ hit í•  ìˆ˜ ìˆì—ˆë‹¤. 100ë²ˆ ë°˜ë³µì„ ìœ„í•´ì„œëŠ” ìë™í™”ê°€ í•„ìš”í•  ê²ƒ ê°™ì•„ íŒŒì´ì¬ì˜ **selenium** ëª¨ë“ˆì„ ì‚¬ìš©í•˜ì˜€ë‹¤.

<br>

![image](https://user-images.githubusercontent.com/37824335/227122380-78447fb2-b013-4d0d-b9f7-d713d74f79de.png)

Webhacking.krì€ ë¡œê·¸ì¸ì„ í•´ì•¼ ë¬¸ì œ í˜ì´ì§€ì— ì ‘ê·¼í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— seleniumì—ì„œ ë¡œê·¸ì¸ í•˜ëŠ” ê³¼ì •ì´ í•„ìš”í•˜ë‹¤. í•´ë‹¹ ê³¼ì •ì€ *Challenge(old) - 32* ì—ì„œ ë‹¤ë£¨ì—ˆë‹¤. ë¬¸ì œ í˜ì´ì§€ë¡œ ë„˜ì–´ê°”ë‹¤.

<br>

![image](https://user-images.githubusercontent.com/37824335/227122499-77e6502a-8969-4a05-b60b-148453e53c72.png)

ë°˜ë³µë¬¸ì„ í†µí•´ 100ë²ˆ hitë¥¼ í•˜ë„ë¡ êµ¬í˜„í•˜ì˜€ê³ ,

<br>

![image](https://user-images.githubusercontent.com/37824335/227122526-ac1271ca-ac22-49a3-85d5-a9624878bcc8.png){: w="400"}

hitëŠ” í…Œì´ë¸” íƒœê·¸ì˜ `onclick` ì†ì„±ìœ¼ë¡œ ìœ„ì™€ ê°™ì´ URLì„ í†µí•´ GET í˜¸ì¶œì„ í•˜ê³  ìˆì—ˆê³ , ë‚˜ì˜ User Nameì„ ë§¤ê°œë³€ìˆ˜ë¡œ í•˜ì—¬ í˜¸ì¶œí•˜ë„ë¡ í•˜ì˜€ë‹¤. ë°˜ë³µì„ í•˜ë©° 'vote_check'ëª…ì˜ cookieë„ ì¤‘ê°„ ì¤‘ê°„ ì‚­ì œ í•´ì£¼ì—ˆê³  ì½”ë“œë¥¼ ì‹¤í–‰í•˜ë‹ˆ í’€ë ¸ë‹¤!
