---
title: '[Pentest] PAYGoat'
date: 2025-09-11 00:00:00
categories: [Pentest]
tags: []
published: True
---

# #Intro

PAYGoat는 가상 뱅킹 애플리케이션의 보안 취약점을 분석하고, 이를 통해 실제 공격 시나리오를 시뮬레이션 할 수 있는 프로젝트이다.

> Github Repostory: <br>
> [https://github.com/stuxctf/PAYGoat](https://github.com/stuxctf/PAYGoat)
{: .prompt-info }

<br>

README.md에 작성되어 있는 내용에 따르면, PAYGoat는 다음과 같은 뱅킹 기능을 제공한다.

- JWT 기반 사용자 등록 및 로그인
- 계좌 잔액 관리 (USD & EUR)
- 사용자 간 계좌 이체
- 프로필 업데이트
- 크레딧 카드 정보 관리

<br>

또한, PAYGoat는 전통적인 스캔 툴로과 정적인 분석으로는 찾기 어려운, 다음과 같은 보안 취약점들을 포함하고 있다고 한다.

- 부적절한 계좌 잔액 관리
- 인증 우회
- object-level 접근 제어 결함
- 음수 금액 처리
- Race condition
- 환율과 계좌 소유자 조작

<br>

<br>

# #Setup

Docker를 이용하여 PAYGoat 환경을 구축할 수 있다.

```bash
git clone https://github.com/stuxctf/PAYGoat
cd PAYGoat
docker-compose up --build -d
```

<br>

`localhost:8000`에서 PAYGoat 애플리케이션에 접근할 수 있다.

<br>

<br>

# #Exploit

## 사용자 프로필/계좌 정보 노출

![image](/assets/posts/250911-1.png)

user1 계정과 user2 계정을 만든 후, user1 프로필로 로그인 후에 첫 번째 탭인 `/profile`에 접속하면 이미지와 같이 `/user/profile/3`로 API 요청이 전송되는 것을 확인할 수 있다.

<br>

![image](/assets/posts/250911-2.png)

로그인 요청 시 받는 response 데이터에 `userID` 값이 `3`으로 설정되어 있는 것을 확인할 수 있다. 따라서 `/user/profile/{userID}` 경로는 userID에 해당하는 사용자의 프로필 정보를 반환 받을 수 있음을 알 수 있다.

<br>

![image](/assets/posts/250911-3.png)

`/user/profile/4` 경로로 요청을 보내면 user2의 프로필 정보를 확인할 수 있다. 즉, object-level 접근 제어 결함이 존재한다.

<br>

![image](/assets/posts/250911-6.png)

이를 이용하면 userID 값이 1인 admin 계정의 프로필 정보도 확인할 수 있다.

<br>

![image](/assets/posts/250911-4.png)

해당 취약점은 사용자 계좌 정보를 조회하는 기능에서도 존재하였다. 계좌 정보를 조회할 때, `/bank/account` 경로로 API 요청이 전송되고 이때 `accountID` 값도 함께 전송되는 것을 확인할 수 있다. 해당 값을 변경하면 다른 사용자의 계좌 정보를 조회할 수 있다.

<br>

## OTP 노출 / Brute Force

![image](/assets/posts/250911-5.png)

첫 로그인 화면 내의 Forgot Password 링크를 클릭하면, Phone number를 입력하여 OTP를 발급받을 수 있다. 해당 요청에 대해서는 `/otp/send` 경로로 `phoneNumber` 필드를 포함하여 API 요청을 보내는데, 응답으로 OTP 값이 그대로 노출되는 것을 확인할 수 있다. 즉, 타인의 전화번호만 있으면 비밀번호를 재설정할 수 있다.

<br>

또한, OTP 값이 4자리 숫자이므로 Brute Force 공격이 가능하다.
